window.customify=window.customify||{},function(t,e,n){e.fontFields=function(){const i=".font-options__wrapper",a=n.customize,s={},o={};const l=function(e){let n=t(e).find(".font-options__options-list").find("[data-field]"),i=e.children(".customify_font_values"),l=c(i.val()),r=t(i).data("customize-setting-link"),f=a(r),h=_.isEmpty(l)?{}:l;if(!0===s[r])return;if(!0===o[r])return;s[r]=!0,n.each((function(e,n){const i=t(n),a=i.data("field");let s=i.val();if(!_.isUndefined(a)&&!i.data("disabled")&&(i.data("touched")||_.isUndefined(h[a]))){if("font_family"===a){const e=t(n.options[n.selectedIndex]),i=e.data("subsets"),a=e.data("variants"),s=e.data("src");s?h.src=s:delete h.src,_.isUndefined(a)?delete h.variants:h.variants=c(a),_.isUndefined(i)?delete h.subsets:h.subsets=c(i)}_.isUndefined(s)||_.isNull(s)||""===s||(_.includes(["letter_spacing","line_height","font_size"],a)&&(s=d(s,n,!1)),h[a]=s)}}));let m=u(h);return i.val(m),f.set(m),s[r]=!1,h};const c=function(t){let e;try{e=JSON.parse(decodeURIComponent(t))}catch(n){e=t}return e},u=function(t){return encodeURIComponent(JSON.stringify(t))},d=function(e,n,i=!0){const a={value:!1,unit:""};if(isNaN(e)){if(void 0!==e.value)a.value=e.value,void 0!==e.unit&&(a.unit=e.unit.toLowerCase());else if(void 0!==e[0])a.value=e[0],void 0!==e[1]&&(a.unit=e[1].toLowerCase());else if("string"==typeof e){const t=e.match(/^([\d.\-+]+)(.+)/i);null!==t&&void 0!==t[1]&&(a.value=t[1],_.isEmpty(t[2])||(a.unit=t[2].toLocaleLowerCase()))}}else a.value=e;if(_.isEmpty(a.unit)){let e="";i?_.isEmpty(t(n).data("value_unit"))?_.isEmpty(t(n).data("unit"))||(e=t(n).data("unit").toLowerCase()):e=t(n).data("value_unit").toLowerCase():_.isEmpty(t(n).data("unit"))?_.isEmpty(t(n).data("value_unit"))||(e=t(n).data("value_unit").toLowerCase()):e=t(n).data("unit").toLowerCase(),a.unit=e}return a};return{init:function(){let e=t(".customify_font_family");void 0!==a.settings.google_fonts_opts&&e.each((function(e,n){let i=t(n).find(".google-fonts-opts-placeholder").first();if(i){i.replaceWith(a.settings.google_fonts_opts);let e=t(n).data("active_font_family");void 0!==e&&t(n).val(e)}})),e.select2({placeholder:"Select a font family"}),e.on("change",(function(e){let n=t(e.target).find("option:selected"),a=t(e.target).closest(i);!function(e,n){let a=c(t(e).data("variants")),s=n.find(".customify_font_weight"),o=s.val()?s.val():s.data("default"),u=[];n.find(".customify_font_values").data("customizeSettingLink");if(t(s).select2().empty(),t(s).data("touched",!1),void 0===a||Object.keys(a).length<2||!_.isUndefined(s.data("disabled")))return s.parent().hide(),void s.parent().prev("label").hide();t.each(a,(function(t,e){let n={id:e,text:e};o==e&&(n.selected=!0),u.push(n)})),t(s).select2({theme:"classic",data:u,minimumResultsForSearch:10}),t(s).on("change",(function(e){let n=t(e.target).closest(i);t(e.target).data("touched",!0),l(n)})),s.parent().show()}(n,a),function(e,n){let a=c(t(e).data("subsets")),s=n.find(".customify_font_subsets"),o=[];if(t(s).select2().empty(),t(s).data("touched",!1),void 0===a||Object.keys(a).length<2||!_.isUndefined(s.data("disabled")))return s.parent().hide(),void s.parent().prev("label").hide();s.parent().show(),s.parent().prev("label").show();let u=c(n.children(".customify_font_values").val()),d=[];_.isUndefined(u.selected_subsets)||_.isEmpty(u.selected_subsets)||(d=u.selected_subsets,Array.isArray(d)||(d=Object.keys(d).map((function(t){return d[t]}))));t.each(a,(function(t,e){if("latin"===e)return;let n={id:e,text:e};-1!==d.indexOf(e)&&(n.selected=!0),o.push(n)})),t(s).select2({data:o}).on("change",(function(e){let n=t(e.target).closest(i);t(e.target).data("touched",!0),l(n)}))}(n,a),l(a)})).on("input",(function(e){t(e.target).data("touched",!0)})),e.each((function(e,n){let l=t(n).closest(i),u=l.children(".customify_font_values"),r=t(u).data("customize-setting-link");a(r).bind((function(e,n){s[this.id]||(u.val(e),function(e){let n=t(e).find(".font-options__options-list").find("[data-field]"),i=e.children(".customify_font_values"),a=c(i.val()),s=t(i).data("customize-setting-link");if(!0===o[s])return;o[s]=!0,n.each((function(e,n){const i=t(n),s=i.data("field");if(void 0!==s&&""!==s&&void 0!==a[s]){if(_.includes(["letter_spacing","line_height","font_size"],s)){let t=d(a[s],n);""!==t.unit&&(i.data("value_unit",t.unit),_.isEmpty(i.attr("unit"))&&i.attr("unit",t.unit));const e=16,o=i.attr("unit").trim().toLowerCase(),l=i.data("value_unit").trim().toLowerCase();o!=l&&(_.includes(["em","rem"],l)&&"px"===o?t.value=t.value*e:_.includes(["em","rem"],o)&&"px"===l&&(t.value=t.value/e)),i.attr("min")&&i.attr("min")>t.value&&i.attr("min",t.value),i.attr("max")&&i.attr("max")<t.value&&i.attr("max",t.value),i.val(t.value)}else i.val(a[s]);i.data("touched",!1),i.trigger("change")}})),o[s]=!1}(l))}))})),t(".customify_font_weight").each((function(e,n){let a={theme:"classic",placeholder:"Select a font weight",minimumResultsForSearch:10};if(0===this.options.length){let e=t(n).closest(i).find(".customify_font_family"),s=e[0].options[e[0].selectedIndex],o=c(t(s).data("variants")),l=[],u=t(n).data("default")||null;if(void 0===o)return t(this).hide(),void t(this).prev("label").hide();t.each(o,(function(t,e){let n={id:e,text:e};null!==u&&e==u&&(n.selected=!0),l.push(n)})),l!==[]&&(a.data=l)}t(this).data("touched",!1),t(this).select2(a),t(this).on("change",(function(e){let n=t(e.target).closest(i);l(n)})).on("input",(function(e){t(e.target).data("touched",!0)}))})),t(".customify_font_subsets").data("touched",!1),t(".customify_font_subsets").select2({placeholder:"Extra Subsets",theme:"classic",minimumResultsForSearch:10}),t(".customify_font_subsets").on("change",(function(e){let n=t(e.target).closest(i);l(n)})).on("input",(function(e){t(e.target).data("touched",!0)}));let n=e.parents(i).find("input[type=range]"),u=e.parents(i).find("select").not("select[class*=' select2'],select[class^='select2']");u.length>0&&(t(u).data("touched",!1),u.on("change",(function(e){let n=t(e.target).closest(i);l(n)})).on("input",(function(e){t(e.target).data("touched",!0)}))),n.length>0&&(t(n).data("touched",!1),n.on("change",(function(e){let n=t(e.target).closest(i);l(n),a.previewer.send("font-changed")})).on("input",(function(e){t(e.target).data("touched",!0)})));const r=this;a.previewer.bind("ready",(function(){r.renderFonts()}))},getValue:function(t){let e=t.children(".customify_font_values");return e.length?c(e.val()):[]},updateValue:function(e,n){let i=e.children(".customify_font_values"),s=t(i).data("customize-setting-link"),o=a(s);i.length&&(_.isArrayLikeObject(n)&&(n=u(n)),i.val(n),o.set(n))},selfUpdateValue:l,encodeValues:u,standardizeNumericalValue:d,determineFontType:function(t){let n="google";return void 0!==e.config.theme_fonts[t]?n="theme_font":void 0!==e.config.cloud_fonts[t]?n="cloud_font":void 0!==e.config.std_fonts[t]&&(n="std_font"),n},convertFontVariantToFVD:function(t){let e,n="n";switch(-1!==(t=String(t)).indexOf("italic")?(n="i",t=t.replace("italic","")):-1!==t.indexOf("oblique")&&(n="o",t=t.replace("oblique","")),t){case"100":e="1";break;case"200":e="2";break;case"300":e="3";break;case"500":e="5";break;case"600":e="6";break;case"700":case"bold":e="7";break;case"800":e="8";break;case"900":e="9";break;default:e="4"}return n+e},renderFonts:function(){t(".customify_font_family").select2({theme:"classic",minimumResultsForSearch:10}).trigger("change")}}}()}(jQuery,customify,wp);