window.customify=window.customify||{},function(t,e,n){e.fontFields=function(){const i=".font-options__wrapper",s=n.customize,o={},a={};function l(e,n=!1,s=""){if(e.length&&(t(e).data("touched",!1),t(e).on("change",(function(e){let n=t(e.target).closest(i);c(n)})).on("input",(function(e){t(e.target).data("touched",!0)})),!0===n)){const n={};_.isEmpty(s)||(n.placeholder=s),t(e).select2(n)}}const c=function(e){let n=t(e).find(".font-options__options-list").find("[data-field]"),i=e.children(".customify_font_values"),l=d(i.val()),c=t(i).data("customize-setting-link"),u=s(c),v=_.isEmpty(l)?{}:l;if(!0===o[c])return;if(!0===a[c])return;o[c]=!0,n.each((function(e,n){const i=t(n),s=i.data("field");let o=i.val();if(!_.isUndefined(s)&&!i.data("disabled")&&(i.data("touched")||_.isUndefined(v[s]))){if("font_family"===s){const e=t(n.options[n.selectedIndex]).data("src");e?v.src=e:delete v.src}_.isUndefined(o)||_.isNull(o)||""===o?delete v[s]:(_.includes(["letter_spacing","line_height","font_size"],s)&&(o=f(o,n,!1)),v[s]=o)}})),delete v.variants,delete v.subsets;let p=r(v);return i.val(p),u.set(p),o[c]=!1,v};const u=function(){const e=t(".js-font-option-toggle");e.on("click",(function(){const n=t(this);!0===n.prop("checked")&&e.not(n).prop("checked",!1)}))},d=function(t){let e;try{e=JSON.parse(decodeURIComponent(t))}catch(n){e=t}return e},r=function(t){return encodeURIComponent(JSON.stringify(t))},f=function(e,n,i=!0){const s={value:!1,unit:""};if(isNaN(e)){if(void 0!==e.value)s.value=e.value,void 0!==e.unit&&(s.unit=e.unit.toLowerCase());else if(void 0!==e[0])s.value=e[0],void 0!==e[1]&&(s.unit=e[1].toLowerCase());else if("string"==typeof e){const t=e.match(/^([\d.\-+]+)(.+)/i);null!==t&&void 0!==t[1]&&(s.value=t[1],_.isEmpty(t[2])||(s.unit=t[2].toLocaleLowerCase()))}}else s.value=e;if(_.isEmpty(s.unit)){let e="";i?_.isEmpty(t(n).data("value_unit"))?_.isEmpty(t(n).data("unit"))||(e=t(n).data("unit").toLowerCase()):e=t(n).data("value_unit").toLowerCase():_.isEmpty(t(n).data("unit"))?_.isEmpty(t(n).data("value_unit"))||(e=t(n).data("value_unit").toLowerCase()):e=t(n).data("unit").toLowerCase(),s.unit=e}return s},v=function(t){let n="std_font";return void 0!==e.config.theme_fonts[t]?n="theme_font":void 0!==e.config.cloud_fonts[t]?n="cloud_font":void 0!==e.config.google_fonts[t]&&(n="google_font"),n},p=function(t,n=!1){switch(!1===n&&(n=v(t)),n){case"theme_font":return e.config.theme_fonts[t];case"cloud_font":return e.config.cloud_fonts[t];case"google_font":return e.config.google_fonts[t];case"std_font":if(void 0!==e.config.std_fonts[t])return e.config.std_fonts[t]}return!1};return{init:function(){const e=t(".customify_font_family");void 0!==s.settings.google_fonts_opts&&e.each((function(e,n){let i=t(n).find(".google-fonts-opts-placeholder").first();if(i){i.replaceWith(s.settings.google_fonts_opts);let e=t(n).data("active_font_family");void 0!==e&&t(n).val(e)}})),e.select2({placeholder:"Select a font family"}),e.on("change",(function(e){const n=e.target.value,s=t(e.target).closest(i),o=p(n);!function(e,n){let i=void 0!==e.variants?e.variants:[],s=n.find(".customify_font_weight"),o=s.val()?s.val():"",a=[];t(s).val(null).empty(),t(s).hasClass("select2-hidden-accessible")&&t(s).select2("destroy");if(t(s).data("touched",!1),void 0===i||Object.keys(i).length<2||!_.isUndefined(s.data("disabled")))return s.parent().hide(),void s.parent().prev("label").hide();a.push({id:"",text:"Auto"}),t.each(i,(function(t,e){let n={id:e,text:e};o==e&&(n.selected=!0),a.push(n)})),t(s).select2({data:a}),s.parent().show(),s.parent().prev("label").show()}(o,s),function(e,n){let i=void 0!==e.subsets?e.subsets:[],s=n.find(".customify_font_subsets"),o=[];t(s).val(null).empty(),t(s).hasClass("select2-hidden-accessible")&&t(s).select2("destroy");if(t(s).data("touched",!1),void 0===i||Object.keys(i).length<2||!_.isUndefined(s.data("disabled")))return s.parent().hide(),void s.parent().prev("label").hide();let a=d(n.children(".customify_font_values").val()),l=[];_.isUndefined(a.selected_subsets)||_.isEmpty(a.selected_subsets)||(l=a.selected_subsets,Array.isArray(l)||(l=Object.keys(l).map((function(t){return l[t]}))));t.each(i,(function(t,e){if("latin"===e)return;let n={id:e,text:e};-1!==l.indexOf(e)&&(n.selected=!0),o.push(n)})),t(s).select2({data:o,placeholder:"More subsets"}),s.parent().show(),s.parent().prev("label").show()}(o,s),c(s)})).on("input",(function(e){t(e.target).data("touched",!0)})),e.each((function(e,n){let l=t(n).closest(i),c=l.children(".customify_font_values"),u=t(c).data("customize-setting-link");s(u).bind((function(e,n){o[this.id]||(c.val(e),function(e){let n=t(e).find(".font-options__options-list").find("[data-field]"),i=e.children(".customify_font_values"),s=d(i.val()),o=t(i).data("customize-setting-link");if(!0===a[o])return;a[o]=!0,n.each((function(e,n){const i=t(n),o=i.data("field");if(void 0!==o&&""!==o&&void 0!==s[o]){if(_.includes(["letter_spacing","line_height","font_size"],o)){let t=f(s[o],n);""!==t.unit&&(i.data("value_unit",t.unit),_.isEmpty(i.attr("unit"))&&i.attr("unit",t.unit));const e=16,a=i.attr("unit").trim().toLowerCase(),l=i.data("value_unit").trim().toLowerCase();a!=l&&(_.includes(["em","rem"],l)&&"px"===a?t.value=t.value*e:_.includes(["em","rem"],a)&&"px"===l&&(t.value=t.value/e)),i.attr("min")&&i.attr("min")>t.value&&i.attr("min",t.value),i.attr("max")&&i.attr("max")<t.value&&i.attr("max",t.value),i.val(t.value)}else i.val(s[o]);i.data("touched",!1),i.trigger("change")}})),a[o]=!1}(l))}))})),l(t(".customify_font_weight"),!0),l(t(".customify_font_subsets"),!0,"More subsets"),l(e.parents(i).find("select").not("select[class*=' select2'],select[class^='select2']"),!1),l(e.parents(i).find("input[type=range]"),!1),u();const n=this;s.previewer.bind("ready",(function(){n.renderFonts()}))},getValue:function(t){let e=t.children(".customify_font_values");return e.length?d(e.val()):[]},updateValue:function(e,n){let i=e.children(".customify_font_values"),o=t(i).data("customize-setting-link"),a=s(o);i.length&&(_.isArrayLikeObject(n)&&(n=r(n)),i.val(n),a.set(n))},selfUpdateValue:c,encodeValues:r,standardizeNumericalValue:f,determineFontType:v,getFontDetails:p,convertFontVariantToFVD:function(t){let e,n="n";switch(-1!==(t=String(t)).indexOf("italic")?(n="i",t=t.replace("italic","")):-1!==t.indexOf("oblique")&&(n="o",t=t.replace("oblique","")),t){case"100":e="1";break;case"200":e="2";break;case"300":e="3";break;case"500":e="5";break;case"600":e="6";break;case"700":case"bold":e="7";break;case"800":e="8";break;case"900":e="9";break;default:e="4"}return n+e},renderFonts:function(){t(".customify_font_family").select2({theme:"classic",minimumResultsForSearch:10}).trigger("change")}}}()}(jQuery,customify,wp);